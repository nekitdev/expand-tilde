The actual expansion was moved to a separate function, `expand_tilde_path`.
